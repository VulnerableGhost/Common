#pragma once

#include <sal.h>
#include "extinterface.h"

class CLdrDriver
{
public:
	CLdrDriver(
		__in void* mainImgBase
		);

	~CLdrDriver();

	void
	LoadDriver(
		__in const void* ntoskrnl,
		__in const extinterface::PACKET& param
		);

protected:
	static
	void
	LoadKernelImports(
		__in const void* ntoskrnl
		);

	void* m_mainImgBase;
};
